<!doctype html>
<html>
	<head>
		<meta charset="UTF-8">
		<title>For Crab, for Glory!</title>
	</head>
	
	<script src="pixi.min.js"></script>
	
	<body>
		<script type="text/javascript">
			
			console.log("Clicky 3 by Mason Hill!");
			console.log("Are you trying to cheat?");
			
			
			// Welcome to a burning hellscape!
			// Everything here is a mess...
			// Going further may cause pain.
			
			
			let type = "WebGL"
			let loader = PIXI.Loader.shared
			var Crab = undefined; // Heheh...
			var loaded = false;
			var frameCount = 0;
			var strength = ["Paper","Cardboard","Plastic","Copper","Bronze","Gilded Bronze","Pig Iron","Cast Iron","Gilded Iron","Steel","Tempered Steel","Gilded Steel","Tungsten","Gilden Tungsten","Titanium","Titanium Alloy","Gilded Titanium","Crab","Pure Crab","Gilden Crab"];
			
			// buttons:
			buttons = [];
			btnBacks = [];
			btnTexts = [];
			btnImg=[];
			
			// Crab button!
			CrabButton = undefined;
			mainOver=false;
			CrabFrags = [];
			
			//menu
			statsTxt=[];
			
			textures=
			[
				PIXI.Texture.from('graphics/Crab0.png'),
				PIXI.Texture.from('graphics/Crab1.png'),
				PIXI.Texture.from('graphics/Crab2.png'),
				PIXI.Texture.from('graphics/Crab3.png')
			]
			
			btntex=
			[
				PIXI.Texture.from('graphics/Gui/button.png'),
				PIXI.Texture.from('graphics/Gui/buttonOn.png'),
			]
			
			icons=
			[
				PIXI.Texture.from('graphics/Gui/Icons/Pickaxe.png'),
				PIXI.Texture.from('graphics/Gui/Icons/iconHelmet.png'),
				PIXI.Texture.from('graphics/Gui/Icons/iconDrillUp.png'),
				PIXI.Texture.from('graphics/Gui/Icons/iconBrain.png'),
				PIXI.Texture.from('graphics/Gui/Icons/Settings.png'),
				
				PIXI.Texture.from('graphics/Gui/Icons/newNode.png'),
				PIXI.Texture.from('graphics/Gui/Icons/NoIcon.png'),
				PIXI.Texture.from('graphics/Gui/Icons/Miner.png'),
				PIXI.Texture.from('graphics/Gui/Icons/iconDrill.png'),
				PIXI.Texture.from('graphics/Gui/Icons/iconLazer.png'),	
			
			]
			
			
			
			// Fonts:
			const Title = new PIXI.TextStyle
			({
				
				fontFamily: 'Arial',
				fontSize: 48,
				fontWeight: 'bold',
				fill: 'White',
				
			});
			const Normal = new PIXI.TextStyle
			({
				
				fontFamily: 'Arial',
				fontSize: 20,
				fontWeight: 'bold',
				fill: 'White',
				
				
			});	
			
			const Small = new PIXI.TextStyle
			({
				
				fontFamily: 'Arial',
				fontSize: 12.5,
				
				fill: 'White',
				
			});	
			
			//Create a Pixi Application
			let app = new PIXI.Application
			(
				{ 
					width: 1200,         // default: 800
					height: 675,        // default: 600
					antialias: true,    // default: false
					transparent: false, // default: false
					resolution: 1       // default: 1
				}
			);
			
			// Utility functions.
			function center ( sprite )
			{  sprite.position.set((app.renderer.width-sprite.width)/2,(app.renderer.height-sprite.height)/2);  }
			
			
			function centerX ( sprite )
			{  sprite.position.x=(app.renderer.width-sprite.width)/2;  }
			
			
			function getRndInteger( min, max ) 
			{  return Math.floor( Math.random( ) * ( max - min ) ) + min;  }
			
			function pp ( num ) // makes numbers nice.
			{
				if(num>=1000000000)
				{
					return (num/1000000000).toFixed(3) + "B";
				}
				else	
				{
					if(num>=1000000)
					{
						return (num/1000000).toFixed(3) + "M";
					}
					else	
					{
						if(num>=1000)
						{
							return (num/1000).toFixed(2) + "K";
						}
						else
						{
							return num;
						}
					}
				}
			}
			function keyboard( value ) 
			{
			  let key = {};
			  key.value = value;
			  key.isDown = false;
			  key.isUp = true;
			  key.press = undefined;
			  key.release = undefined;
			  //The `downHandler`
			  key.downHandler = event => 
			  {
				if (event.key === key.value) 
				{
				  if (key.isUp && key.press) key.press();
				  key.isDown = true;
				  key.isUp = false;
				  event.preventDefault();
				}
			  };

			  //The `upHandler`
			  key.upHandler = event => 
			  {
				if (event.key === key.value) 
				{
				  if (key.isDown && key.release) key.release();
				  key.isDown = false;
				  key.isUp = true;
				  event.preventDefault();
				}
			  };

			  //Attach event listeners
			  const downListener = key.downHandler.bind(key);
			  const upListener = key.upHandler.bind(key);

			  window.addEventListener(
				"keydown", downListener, false
			  );
			  window.addEventListener(
				"keyup", upListener, false
			  );

			  // Detach event listeners
			  key.unsubscribe = () => {
				window.removeEventListener("keydown", downListener);
				window.removeEventListener("keyup", upListener);
			  };

			  return key;
			}
			
			
			
			
			
			
			
			// Everything that is not graphical, mostly.
			var Game =
			{
				saving: 0,
				Crab: 0,
				antiCheat:0,
				allTimeCrab: 0,
				spent:0,
				Cps: 0,
				version:2, // Updated Nov 25, 2020, to prevent overriding normal clicky3
				node:
				{
					total: 5000,
					left:  5000,
					costs: [1000,100000],
					filler:
					{
						name: 'Prospect',
						info: 'look for more Crab.',
						
						
						open: function()
						{
							buttons[5].children[0].texture=btntex[1];
							
								
							CrabButton.visible=! CrabButton.visible;	
							CrabMenu.visible=! CrabMenu.visible;	
							settingsMenu.visible=false;
								
								
							

						
						},
						
						Alaska: function()
						{
							
							if(Game.Crab >= Game.node.costs[0])
							{
								Alaska.tint=0xAAFFAA;
								Game.Crab-=Game.node.costs[0];
								Game.antiCheat-=Game.node.costs[0];
								Game.node.left+=10000;
								Game.node.total=Game.node.left;
								Game.spent+=Game.node.costs[0];
							}
							else
							{
								Alaska.tint=0xFFAAAA;
							}
						},
						
						California: function()
						{
							
							if(Game.Crab >= Game.node.costs[1])
							{
								California.tint=0xAAFFAA;
								Game.Crab-=Game.node.costs[1];
								Game.antiCheat-=Game.node.costs[1];
								Game.node.left+=1100000;
								Game.node.total=Game.node.left;
								Game.spent+=Game.node.costs[1];
							}
							else
							{
								California.tint=0xFFAAAA;
							}
						}
					}
				},
			
				
				
				
				Pickaxe:
				{
					//Game data:
					amount: 1,
					baseCost: 10, // This Might do something? I don't think so.
					cost: 10,
					costExponent: 3,
					baseCps: 0, // no Cps.
					Cps: 0,

					// Text Data:
					name: 'Stronger Pick',
					info: 'x2 Crab per click.',

					up: function()
					{

						buttons[0].children[0].texture=btntex[1];
						// I'm going to do this the dirty way. Sorry.
						// Only I care?
						// Eh.
						if(Game.Crab>=Game.Pickaxe.cost)
						{
							Game.spent+=Game.Pickaxe.cost;
						
							buttons[0].children[0].tint=0x55FF55;
							Game.Pickaxe.amount*=2;
							Game.Crab-=Game.Pickaxe.cost;
							Game.antiCheat-=Game.Pickaxe.cost;
							Game.Pickaxe.cost=Math.floor(Game.Pickaxe.cost*Game.Pickaxe.costExponent);
							btnTexts[20].text=pp(Game.Pickaxe.amount)+" gpc, cost: "+pp(Game.Pickaxe.cost);
							
						}
						else
						{
							buttons[0].children[0].tint=0xFFAAAA;
						}
					}

				},
				
				Settings:
				{
					display:function()
					{
						// quick test.
						
						buttons[4].children[0].texture=btntex[1];
						buttons[4].children[0].tint=0xAAAAAA;
						
						CrabButton.visible=!CrabButton.visible;
						CrabMenu.visible=false;
						settingsMenu.visible=!settingsMenu.visible;
						
						
						
					}
				}, 

				Miner:
				{
					//Game data:
					amount: 0,
					baseCost: 10, // This Might do something? I don't think so.
					cost: 25,
					costExponent: 1.1,
					baseCps: 1, 
					Cps: 0,

					// Text Data:
					name: 'Miner',
					info: 'Mines 1 Cps.',
					up: function()
					{
						buttons[7].children[0].texture=btntex[1];
						// I'm going to do this the dirty way. Sorry.
						// Only I care?
						// Eh.
						if(Game.Crab>=Game.Miner.cost)
						{
							Game.spent+=Game.Miner.cost;
							buttons[7].children[0].tint=0x55FF55;
							Game.Miner.amount++;
							Game.Crab-=Game.Miner.cost;
							Game.antiCheat-=Game.Miner.cost;
							Game.Miner.cost=Math.floor(Game.Miner.cost*Game.Miner.costExponent);
							Game.Miner.Cps = Game.Miner.baseCps * Game.Miner.amount;
							btnTexts[27].text=pp(Game.Miner.Cps)+" Cps, cost: "+pp(Game.Miner.cost);
							
						}

						else
						{
							buttons[7].children[0].tint=0xFFAAAA;
						}
					}

				},
				
				Drill:
				{
					//Game data:
					amount: 0,
					baseCost: 10, // This Might do something? I don't think so.
					cost: 1000,
					costExponent: 1.1,
					baseCps: 10, 
					Cps: 0,

					// Text Data:
					name: 'Drill',
					info: 'Drills 10 Cps.',
					up: function()
					{
						buttons[8].children[0].texture=btntex[1];
						// I'm going to do this the dirty way. Sorry.
						// Only I care?
						// Eh.
						if(Game.Crab>=Game.Drill.cost)
						{
							Game.spent+=Game.Drill.cost;
							buttons[8].children[0].tint=0x55FF55;
							Game.Drill.amount++;
							Game.Crab-=Game.Drill.cost;
							Game.antiCheat-=Game.Drill.cost;
							Game.Drill.cost=Math.floor(Game.Drill.cost*Game.Drill.costExponent);
							Game.Drill.Cps = Game.Drill.baseCps * Game.Drill.amount;
							btnTexts[28].text=pp(Game.Drill.Cps)+" Cps, cost: "+pp(Game.Drill.cost);
							
						}

						else
						{
							buttons[8].children[0].tint=0xFFAAAA;
						}
					}

				},
				
				Laser:
				{
					//Game data:
					amount: 0,
					baseCost: 10, // This Might do something? I don't think so.
					cost: 30000,
					costExponent: 1.1,
					baseCps: 100, 
					Cps: 0,

					// Text Data:
					name: 'Laser',
					info: 'Zaps 100 Cps.',
					up: function()
					{
						buttons[9].children[0].texture=btntex[1];
						// I'm going to do this the dirty way. Sorry.
						// Only I care?
						// Eh.
						if(Game.Crab>=Game.Laser.cost)
						{
							Game.spent+=Game.Laser.cost;
							buttons[9].children[0].tint=0x55FF55;
							Game.Laser.amount++;
							Game.Crab-=Game.Laser.cost;
							Game.antiCheat-=Game.Laser.cost;
							Game.Laser.cost=Math.floor(Game.Laser.cost*Game.Laser.costExponent);
							Game.Laser.Cps = Game.Laser.baseCps * Game.Laser.amount;
							btnTexts[29].text=pp(Game.Laser.Cps)+" Cps, cost: "+pp(Game.Laser.cost);
							
						}

						else
						{
							buttons[9].children[0].tint=0xFFAAAA;
						}
					}

				},
				
				
				Helmet:
				{
					//Game data:
					amount: 0,
					baseCost: 500, // This Might do something? I don't think so.
					cost: 500,
					costExponent: 1.6,
					

					// Text Data:
					name: 'Harder Hats',
					info: '+1 to miner Cps.',
					
					up: function()
					{
						buttons[1].children[0].texture=btntex[1];
						// I'm going to do this the dirty way. Sorry.
						// Only I care?
						// Eh.
						if(Game.Crab>=Game.Helmet.cost)
						{
							Game.spent+=Game.Helmet.cost;
							buttons[1].children[0].tint=0x55FF55;
							Game.Helmet.amount++;
							Game.Crab-=Game.Helmet.cost;
							Game.antiCheat-=Game.Helmet.cost;
							Game.Helmet.cost=Math.floor(Game.Helmet.cost*Game.Helmet.costExponent);
							btnTexts[21].text="cost: "+pp(Game.Helmet.cost);
							
							// change miner accordingly.
							Game.Miner.baseCps++;
							btnTexts[17].text="Mines "+Game.Miner.baseCps+" Cps.";
							Game.Miner.Cps = Game.Miner.baseCps * Game.Miner.amount;
							btnTexts[27].text=pp(Game.Miner.Cps)+" Cps, cost: "+pp(Game.Miner.cost);
							
							
						}

						else
						{
							buttons[1].children[0].tint=0xFFAAAA;
						}
					}
					
				},
				
				Parts:
				{
					//Game data:
					amount: 0,
					baseCost: 500, // This Might do something? I don't think so.
					cost: 5000,
					costExponent: 1.6,
					

					// Text Data:
					name: 'Faster Drills',
					info: '+10 to Drill Cps.',
					
					up: function()
					{
						buttons[2].children[0].texture=btntex[1];
						// I'm going to do this the dirty way. Sorry.
						// Only I care?
						// Eh.
						if(Game.Crab>=Game.Parts.cost)
						{
							
							Game.spent+=Game.Parts.cost;
							buttons[2].children[0].tint=0x55FF55;
							Game.Parts.amount++;
							Game.Crab-=Game.Parts.cost;
							Game.antiCheat-=Game.Parts.cost;
							Game.Parts.cost=Math.floor(Game.Parts.cost*Game.Parts.costExponent);
							btnTexts[22].text="cost: "+pp(Game.Parts.cost);
							
							// change drilr accordingly.
							Game.Drill.baseCps+=10;
							btnTexts[18].text="Mines "+Game.Drill.baseCps+" Cps.";
							Game.Drill.Cps = Game.Drill.baseCps * Game.Drill.amount;
							btnTexts[28].text=pp(Game.Drill.Cps)+" Cps, cost: "+pp(Game.Drill.cost);
							
							
						}

						else
						{
							buttons[2].children[0].tint=0xFFAAAA;
						}
					}
					
				},
				
				Brain:
				{
					//Game data:
					amount: 0,
					baseCost: 500, // This Might do something? I don't think so.
					cost: 50000,
					costExponent: 1.6,
					

					// Text Data:
					name: 'Smarter Lasers',
					info: '+100 to Laser Cps.',
					
					up: function()
					{
						buttons[3].children[0].texture=btntex[1];
						// I'm going to do this the dirty way. Sorry.
						// Only I care?
						// Eh.
						if(Game.Crab>=Game.Brain.cost)
						{
							
							Game.spent+=Game.Brain.cost;
							buttons[3].children[0].tint=0x55FF55;
							Game.Brain.amount++;
							Game.Crab-=Game.Brain.cost;
							Game.antiCheat-=Game.Brain.cost;
							Game.Brain.cost=Math.floor(Game.Brain.cost*Game.Brain.costExponent);
							btnTexts[23].text="cost: "+pp(Game.Brain.cost);
							
							
						
							// change drilr accordingly.
							Game.Laser.baseCps+=100;
							btnTexts[19].text="Zaps "+Game.Laser.baseCps+" Cps.";
							Game.Laser.Cps = Game.Laser.baseCps * Game.Laser.amount;
							btnTexts[29].text=pp(Game.Laser.Cps)+" Cps, cost: "+pp(Game.Laser.cost);
							
							
						}

						else
						{
							buttons[2].children[0].tint=0xFFAAAA;
						}
					}
					
				},
				Prospector:
				{
					on:false,
					owned:false,
					cost: 500000,
					
					name: "???",
					info: "What's this?",
					up: function()
					{
						buttons[6].children[0].texture=btntex[1];
						if(Game.Crab>=Game.Prospector.cost)
						{
							buttons[6].children[2].text="Prospector";
							buttons[6].children[3].text="an auto-Prospector";
							buttons[6].children[4].text="On. Click to toggle";
							buttons[6].children[1].texture=PIXI.Texture.from("graphics/Gui/Icons/iconProspector.png");
							buttons[6].children[0].tint=0x55FF55;
						
							Game.spent+=Game.Prospector.cost;
							Game.Crab-=Game.Prospector.cost;
							Game.antiCheat-=Game.Prospector.cost;
							
							Game.Prospector.owned=true;
							Game.Prospector.on=true;
							Game.Prospector.cost=Infinity;
							buttons[6].on('pointerdown', Game.Prospector.toggle);
						}
						else
						{
							buttons[6].children[0].tint=0xFFAAAA;
						}
						
					},
					
					toggle: function()
					{
						
						
						Game.Prospector.on=!Game.Prospector.on;
						if(Game.Prospector.on)
						{
							buttons[6].children[4].text="On. Click to toggle";
						}
						else
						{
							buttons[6].children[4].text="Off. Click to toggle";
						}
					},
				
				},
				Deleter:
				{
					open:function()
					{
						settingsMenu.visible=false;
						CrabMenu.visible=false;
						CrabButton.visible=false;
						deleteMenu.visible=true;
						
					},
					
					close:function()
					{
						deleteMenu.visible=false;
					},
					
					delete:function()
					{
						localStorage.clear();
						document.location.reload();
					}
				},
				
				init: function()
				{
					
					
					//Initialize!
					if( ! PIXI.utils.isWebGLSupported( ) )
						type = "canvas"


					
					

					// Make it stylish.
					app.renderer.backgroundColor = 0xFF5555;
					app.renderer.view.style.position = "relative";
					app.renderer.view.style.borderStyle = "solid";
					app.renderer.view.style.display = "block";

					//Add the canvas that Pixi automatically created for you to the HTML document
					document.body.appendChild( app.view );

					

					// load all nessecery files.
					loader
						.add("graphics/Background.png")
						.add("graphics/Glow.png")
						.add( "graphics/CrabFrag.png" )
						.add( "graphics/Gui/menu.png" )
						.add( "graphics/Gui/header.png" )
						.add( "graphics/Gui/vertBar.png")
						.add("graphics/Gui/menuBack.png")
						.add("graphics/Gui/Icons/iconAlaska.png")
						.add("graphics/Gui/Icons/iconCalifornia.png")
						.add("graphics/Gui/Icons/iconProspector.png")
						.load( Graphics.init ); // setup Graphics.
					
					

					
					
					},
			    	
				
				
				
				
				
					mine: function() // Click? woo!
					{
						
						
						if(Game.node.left>0)
						{
							
							
							if(Game.node.left <Game.Pickaxe.amount)
							{
								
								Game.Crab += Game.node.left;
								Game.allTimeCrab += Game.node.left;
								Game.antiCheat += Game.node.left;
								Game.node.left = 0;
								
							}
							else
							{
								
								Game.Crab += Game.Pickaxe.amount;
								Game.allTimeCrab+= Game.Pickaxe.amount;
								Game.antiCheat += Game.Pickaxe.amount;
								Game.node.left-=Game.Pickaxe.amount;
								
							}
						}
						else
						{
							if(Game.Crab<1000)
							{
								Game.saving++
							}
							
							if(Game.saving>=30)
							{
								Game.saving=0;
								Game.node.total=5001;
								Game.node.left=Game.node.costs[0]-Game.Crab;
								
							}
						}
						
						Graphics.Main.Down();
					},
				
				
				
				
				
					update: function( delta )
					{
						buttons[4].visible=true;
						frameCount++;
						
						if(loaded==false)
						{
							loaded=true;
							// Load savegame:
							if( localStorage.getItem("version") == Game.version )
							{

								Game.Crab=parseInt(localStorage.getItem("allTimeCrab"));
								Game.allTimeCrab=parseInt(localStorage.getItem("allTimeCrab"));

								for( i=0; i<Math.log(parseInt(localStorage.getItem("pick"))) / Math.log(2); i++)
								{
									Game.Pickaxe.up();
									buttons[0].visible=true;
									buttons[0].children[0].tint=0xbbbbbb;
									buttons[0].children[0].texture=btntex[0];
								}
								
								
								for( i=0; i<parseInt(localStorage.getItem("hat")); i++)
								{
									Game.Helmet.up();
									buttons[1].visible=true;
									buttons[1].children[0].tint=0xbbbbbb;
									buttons[1].children[0].texture=btntex[0];
								}
								buttons[1].tint=0xbbbbbb;
								
								for( i=0; i<parseInt(localStorage.getItem("part")); i++)
								{
									Game.Parts.up();
									buttons[2].visible=true;
									buttons[2].children[0].tint=0xbbbbbb;
									buttons[2].children[0].texture=btntex[0];
								}
								buttons[2].tint=0xbbbbbb;
								
								for( i=0; i<parseInt(localStorage.getItem("brain")); i++)
								{
									Game.Brain.up();
									buttons[3].visible=true;
									buttons[3].children[0].tint=0xbbbbbb;
									buttons[3].children[0].texture=btntex[0];
								}
								buttons[3].tint=0xbbbbbb;
								
								if(Game.allTimeCrab>=3000)
								{
								   buttons[5].visible=true;
								}
								
								if(localStorage.getItem("prospector")=="true")
								{
									buttons[6].visible=true;
									Game.Prospector.up();
									buttons[6].children[0].tint=0xbbbbbb;
									buttons[6].children[0].texture=btntex[0];
								}
								
								for( i=0; i<parseInt(localStorage.getItem("miner")); i++)
								{
									Game.Miner.up();
									buttons[7].visible=true;
									buttons[7].children[0].tint=0xbbbbbb;
									buttons[7].children[0].texture=btntex[0];
								}
								buttons[7].tint=0xbbbbbb;
								
								for( i=0; i<parseInt(localStorage.getItem("drill")); i++)
								{
									Game.Drill.up();
									buttons[8].visible=true;
									buttons[8].children[0].tint=0xbbbbbb;
									buttons[8].children[0].texture=btntex[0];
								}
								buttons[8].tint=0xbbbbbb;
								
								for( i=0; i<parseInt(localStorage.getItem("laser")); i++)
								{
									Game.Laser.up();
									buttons[9].visible=true;
									buttons[9].children[0].tint=0xbbbbbb;
									buttons[9].children[0].texture=btntex[0];
								}
								buttons[9].tint=0xbbbbbb;
								
								Game.node.total=parseInt(localStorage.getItem("nodeTotal"))
								Game.node.left=parseInt(localStorage.getItem("nodeLeft"))
								
								Game.spent=parseInt(localStorage.getItem("spent"));
								Game.Crab=Game.allTimeCrab-Game.spent;
								Game.antiCheat=Game.Crab;
							}
							else
							{
								// set up new save.
								localStorage.setItem("version", Game.version);
							}
						}
						
						if( !settingsMenu.visible & !CrabMenu.visible & !deleteMenu.visible )
						{
							CrabButton.visible=true;
						}
						else
						{
							CrabButton.visible=false;	
						}
						
						// once/Sec
						if( frameCount % 60 == 0)
						{
							
							// update stats ( even if invisible. )
							if(Math.log(Game.Pickaxe.amount) / Math.log(2)>strength.length)
							{
								var one = "Devine Crab";	
							}
							else
							{
								var one = strength[Math.log(Game.Pickaxe.amount) / Math.log(2)];
							}
							   
							if(Game.Helmet.amount > strength.length)
							{
								var two = "Devine Crab";	
							}
							else
							{
								var two = strength[Game.Helmet.amount];
							}
							
							if(Game.Parts.amount > strength.length)
							{
								var three = "Devine Crab";	
							}
							else
							{
								var three = strength[Game.Parts.amount];
							}
							
							if(Game.Brain.amount > strength.length)
							{
								var four = "Devine Crab";	
							}
							else
							{
								var four = strength[Game.Brain.amount];
							}
										
							statsTxt[0].text="- Current Crab: " + pp(Game.Crab);
							statsTxt[1].text="- All Time Crab: " + pp(Game.allTimeCrab);
							statsTxt[2].text="- Spent Crab: " + pp(Game.spent);
							statsTxt[5].text="- Pick strength: " + one;
							statsTxt[6].text="- Miner amount: " + Game.Miner.amount;
							statsTxt[7].text="- Helmet strength: " + two;
							statsTxt[8].text="- Drill amount: " + Game.Drill.amount;
							statsTxt[9].text="- Drill Strength: " + three;
							statsTxt[10].text="- Laser amount: " + Game.Laser.amount;
							statsTxt[11].text="- Brain Smartness Rank: " + four;
							
							// save game.
							localStorage.setItem("allTimeCrab",Game.allTimeCrab);
							localStorage.setItem("spent",Game.spent);
							
							localStorage.setItem("nodeTotal",Game.node.total);
							localStorage.setItem("nodeLeft",Game.node.left);
							
							localStorage.setItem("pick",Game.Pickaxe.amount);
							localStorage.setItem("hat",Game.Helmet.amount);
							localStorage.setItem("part",Game.Parts.amount);
							localStorage.setItem("brain",Game.Brain.amount);
							
							localStorage.setItem("prospector",Game.Prospector.owned);
							localStorage.setItem("miner",Game.Miner.amount);
							localStorage.setItem("drill",Game.Drill.amount);
							localStorage.setItem("laser",Game.Laser.amount);
							
						}
						
						
						
						//cheat detection.
						if(Crab!=undefined)
						{
							
							Crab=undefined;
							var message = getRndInteger(0,3);
							
							if( message == 0)
							{
								console.log("You aren't even close.");
							}
							else if (message== 1)
							{
								console.log("A swing and a miss, there.");
							}
							else
							{
								console.log("Nope, dude. Not even close to changing anything.");
							}
							
						}
						
						if(Math.round(Game.spent+Game.Crab)!=Math.round(Game.allTimeCrab) && Math.round(Game.spent+Game.Crab)+1!=Math.round(Game.allTimeCrab) && Math.round(Game.spent+Game.Crab)-1!=Math.round(Game.allTimeCrab))
						{
							
							console.log(" Well, you're getting closer, but not by much.");
							console.log(Math.round(Game.spent+Game.Crab)+" all: "+Math.round(Game.allTimeCrab))
							Game.Crab=Game.allTimeCrab-Game.spent;
							Game.antiCheat=Game.Crab;
							
						}
						else
						{
							if( Game.Crab != Game.antiCheat )
							{

								if(Game.Crab < Game.antiCheat)
								{
									Game.antiCheat=Game.Crab;
								}
								else
								{
									Game.Crab=Game.antiCheat;
								}

								// If you're reading this comment, you get a cookie.
								// Now you can probably cheat.
								console.log(" \"Ah!\" you say, \" I must have done it now!\" ")
								console.log("But alas, no. You've been stopped in your tracks.");

							}
						}
						
						
						
						
						
						// Cps calc:
						Game.Cps = Game.Miner.Cps + Game.Drill.Cps + Game.Laser.Cps;
						
						// Perform Calc.
						if(!Game.node.left==0)
						{
							if(Game.Cps/60>Game.node.left)
							{
								Game.Crab+=Game.node.left
								Game.antiCheat+=Game.node.left
								Game.allTimeCrab+=Game.node.left
								Game.node.left=0
							}
							else
							{
								Game.Crab+=Game.Cps/60;
								Game.antiCheat+=Game.Cps/60;
								Game.allTimeCrab+=Game.Cps/60;
								Game.node.left-=Game.Cps/60;
							}
							
						}
						
						// Prospector.
						if(Game.Prospector.on)
						{
							
							//we need Crab.
							if(Game.node.left<=Game.node.total/2)
							{
								if(Game.Crab>=Game.node.costs[1])
								{
									Game.node.filler.California();
								}
								else
								{
									if(Game.Crab>=Game.node.costs[0])
									{
										Game.node.filler.Alaska();
									}
								}
							}
							
						}
						
						
						// Check price:
						if(Game.Crab>=Game.Pickaxe.cost)
						{
							buttons[0].children[1].tint=0xFFFFFF;
							
						}
						else
						{
							buttons[0].children[1].tint=0xBBBBBB;
						}
						
						if(Game.Crab>=Game.Helmet.cost)
						{
							buttons[1].children[1].tint=0xFFFFFF;
							
						}
						else
						{
							buttons[1].children[1].tint=0xBBBBBB;
						}
						
						
						
					 
						
						
						if(Game.Crab>=Game.Miner.cost)
						{
							buttons[7].children[1].tint=0xFFFFFF;
							
						}
						else
						{
							buttons[7].children[1].tint=0xBBBBBB;
						}
						
						if(Game.Crab>=Game.Drill.cost)
						{
							buttons[8].children[1].tint=0xFFFFFF;
							
						}
						else
						{
							buttons[8].children[1].tint=0xBBBBBB;
						}
						
						if(Game.Crab>=Game.Laser.cost)
						{
							buttons[9].children[1].tint=0xFFFFFF;
							
						}
						else
						{
							buttons[9].children[1].tint=0xBBBBBB;
						}
						
						if(Game.Crab>=Game.Parts.cost)
						{
							buttons[2].children[1].tint=0xFFFFFF;
							
						}
						else
						{
							buttons[2].children[1].tint=0xBBBBBB;
						}
						
						if(Game.Crab>=Game.Brain.cost)
						{
							buttons[3].children[1].tint=0xFFFFFF;
							
						}
						else
						{
							buttons[3].children[1].tint=0xBBBBBB;
						}
						
						if(Game.Crab>=Game.Prospector.cost||Game.Prospector.on==true)
						{
							buttons[6].children[1].tint=0xFFFFFF;
							
						}
						else
						{
							buttons[6].children[1].tint=0xBBBBBB;
						}
						
						// Unlocks:
						
						//unlock mining
						if(Game.allTimeCrab>=Game.Pickaxe.cost)
						{
							buttons[0].visible=true;
						}
						
						// unlock miners.
						if(Game.allTimeCrab>=Game.Miner.cost)
						{
							buttons[7].visible=true;
						}
						
						//unlock Helmets.
						if(Game.Miner.amount>=5)
						{
							buttons[1].visible=true;
						}
						
						//unlock Helmets.
						if(Game.Drill.amount>=5)
						{
							buttons[2].visible=true;
						}
						
						//unlock Helmets.
						if(Game.Miner.amount>39)
						{
							buttons[8].visible=true;
						}
						
						//unlock Laser
						if(Game.Drill.amount>24)
						{
							buttons[9].visible=true;
						}
						
						//unlock Laser
						if(Game.Laser.amount>=3)
						{
							buttons[3].visible=true;
						}
						
						//unlock Laser
						if(Game.Laser.amount>=5)
						{
							buttons[6].visible=true;
						}
						
						
					}



				}
				
				
			
			function unlockAll()
			{
				for( i in buttons )
				{
					buttons[i].visible=true;
				}
			}
			
			
			
			
			
			
			
			
			
			
			
			var Graphics = 
			{
			
			
			
			//set everything up.    
				init: function( ) 
				{
					// Make containers:
					centerStuff = new PIXI.Container();
					settingsMenu = new PIXI.Container();
					CrabMenu = new PIXI.Container();
					deleteMenu = new PIXI.Container();
						
					// Create pre-existing sprites
					CrabButton = new PIXI.Sprite( textures[ 0 ] );
					back = new PIXI.Sprite
					(
						loader.resources["graphics/Background.png"].texture
					);
					glow = new PIXI.Sprite
					(
						loader.resources["graphics/Glow.png"].texture
					);
					menuLeft = new PIXI.Sprite
					(
						loader.resources["graphics/Gui/menu.png"].texture
					);
					menuRight = new PIXI.Sprite
					(
						loader.resources["graphics/Gui/menu.png"].texture
					);
					barLeft = new PIXI.Sprite
					(
						loader.resources["graphics/Gui/vertBar.png"].texture
					);
					barRight = new PIXI.Sprite
					(
						loader.resources["graphics/Gui/vertBar.png"].texture
					);
					headerLeft = new PIXI.Sprite
					(
						loader.resources["graphics/Gui/header.png"].texture
					);
					headerRight = new PIXI.Sprite
					(
						loader.resources["graphics/Gui/header.png"].texture
					);
					menuBack = new PIXI.Sprite
					(
						loader.resources["graphics/Gui/menuBack.png"].texture
					);
					menuBack2 = new PIXI.Sprite
					(
						loader.resources["graphics/Gui/menuBack.png"].texture
					);
					
					menuBack3 = new PIXI.Sprite
					(
						loader.resources["graphics/Gui/menuBack.png"].texture
					);

					Alaska = new PIXI.Sprite
					(
						loader.resources["graphics/Gui/Icons/iconAlaska.png"].texture
					);
					
					California = new PIXI.Sprite
					(
						loader.resources["graphics/Gui/Icons/iconCalifornia.png"].texture
					);
					
					saveButton = new PIXI.Sprite(btntex[0]);
					yesButton = new PIXI.Sprite(btntex[0]);
					noButton = new PIXI.Sprite(btntex[0]);

					// buttons!
					for( i = 0; i<10; i++)
					{

						buttons[i] = new PIXI.Container
						btnBacks[i]= new PIXI.Sprite(btntex[0]);

						btnImg[i] = new PIXI.Sprite(icons[i]);


						buttons[i].addChild(btnBacks[i]);
						buttons[i].addChild(btnImg[i]);

						buttons[i].visible = false;
						buttons[i].interactive = true;
						buttons[i].buttonMode = true;
						buttons[i]
							.on( 'pointerup', Graphics.onButtonUp )
							.on( 'pointerover', Graphics.onButtonOver )
							.on( 'pointerout', Graphics.onButtonOut );
						buttons[i].scale.set(1.144,.95);
						btnBacks[i].tint=0xBBBBBB
						btnImg[i].tint=0xBBBBBB;
						center(buttons[i]);


					}



					// Make text.
					mainText = new PIXI.Text( 'Something has gone wrong.', Title );
					CpsText = new PIXI.Text( 'oh no...', Normal )
					leftHeader = new PIXI.Text( 'Upgrades', Title );
					rightHeader = new PIXI.Text( 'Autominers', Title );
					goneText = new PIXI.Text( 'Crab depleted!', Normal );
					watermark = new PIXI.Text( 'Clicky 3 By Mason Hill', Small );

					//button text
					btnTexts[0]= new PIXI.Text( Game.Pickaxe.name, Normal );
					btnTexts[1]= new PIXI.Text( Game.Helmet.name, Normal );
					btnTexts[2]= new PIXI.Text( Game.Parts.name, Normal );
					btnTexts[3]= new PIXI.Text( 'Smart Lasers', Normal );
					btnTexts[4]= new PIXI.Text( 'Stats', Normal );

					btnTexts[5]= new PIXI.Text( Game.node.filler.name, Normal );
					btnTexts[6]= new PIXI.Text( Game.Prospector.name, Normal );
					btnTexts[7]= new PIXI.Text( Game.Miner.name, Normal );
					btnTexts[8]= new PIXI.Text( Game.Drill.name, Normal );
					btnTexts[9]= new PIXI.Text( Game.Laser.name, Normal );

					btnTexts[10]= new PIXI.Text( Game.Pickaxe.info, Small );
					btnTexts[11]= new PIXI.Text( Game.Helmet.info,Small );
					btnTexts[12]= new PIXI.Text( Game.Parts.info, Small );
					btnTexts[13]= new PIXI.Text( Game.Brain.info, Small );
					btnTexts[14]= new PIXI.Text( 'See game stats.', Small );

					btnTexts[15]= new PIXI.Text( Game.node.filler.info, Small );
					btnTexts[16]= new PIXI.Text( Game.Prospector.info, Small );
					btnTexts[17]= new PIXI.Text( Game.Miner.info, Small );
					btnTexts[18]= new PIXI.Text( Game.Drill.info, Small );
					btnTexts[19]= new PIXI.Text( Game.Laser.info, Small );

					btnTexts[20]= new PIXI.Text( Game.Pickaxe.amount + ' g/click, cost: ' + Game.Pickaxe.cost, Small );
					btnTexts[21]= new PIXI.Text( 'Cost: ' + Game.Helmet.cost,Small );
					btnTexts[22]= new PIXI.Text( 'Cost: 5.00K', Small );
					btnTexts[23]= new PIXI.Text( 'Cost: '+pp(Game.Brain.cost), Small );
					btnTexts[24]= new PIXI.Text( '', Small );

					btnTexts[25]= new PIXI.Text( 'even if you have some.', Small );
					btnTexts[26]= new PIXI.Text( 'Cost: ' + pp(Game.Prospector.cost), Small );
					btnTexts[27]= new PIXI.Text( 'Cost: 25', Small );
					btnTexts[28]= new PIXI.Text( 'Cost: 1.00K', Small );
					btnTexts[29]= new PIXI.Text( 'Cost: '+pp(Game.Laser.cost), Small );
					
					statsHeader= new PIXI.Text('Game Stats', Title);
					statsTxt[0] = new PIXI.Text('- Current Crab : IDK',Normal);
					statsTxt[1] = new PIXI.Text('- all time Crab : IDK',Normal);
					statsTxt[2] = new PIXI.Text('- Spent Crab: IDK',Normal);
					statsTxt[3] = new PIXI.Text('',Normal);
					statsTxt[4] = new PIXI.Text('Upgrades:',Normal);
					statsTxt[5] = new PIXI.Text('- Pick Strength: IDK',Normal);
					statsTxt[6] = new PIXI.Text('- Miners: IDK',Normal);
					statsTxt[7] = new PIXI.Text('- Hat strength: IDK',Normal);
					statsTxt[8] = new PIXI.Text('- Drill Amount: IDK',Normal);
					statsTxt[9] = new PIXI.Text('- Drill Strength: IDK',Normal);
					statsTxt[10] = new PIXI.Text('- Laser Amount: IDK',Normal);
					statsTxt[11] = new PIXI.Text('- Laser goodness: IDK',Normal);
					
					
					CrabHeader= new PIXI.Text('Prospect for Crab:', Title);
					
					AlaskaHeader= new PIXI.Text('Alaska', Normal);
					AlaskaCost= new PIXI.Text('Cost: 1,000', Small);
					AlaskaYield= new PIXI.Text('Yield: ~10.00K', Small);
					
					CaliforniaHeader= new PIXI.Text('California', Normal);
					CaliforniaCost= new PIXI.Text('Cost: 100,000', Small);
					CaliforniaYield= new PIXI.Text('Yield: ~1.10M', Small);
					
					saveLabel= new PIXI.Text('Wipe Save', Normal);
					
					deleteTitle= new PIXI.Text('Wipe Save?', Title);
					deleteMessage= new PIXI.Text('This will erase all game data. Are you sure?', Normal);
					yesLabel= new PIXI.Text('Yes', Title);
					noLabel= new PIXI.Text('No', Title);
					// add everything
					
					app.stage.addChild( back );
					app.stage.addChild( glow );
					centerStuff.addChild(CrabButton);
					centerStuff.addChild(mainText);
					centerStuff.addChild(CpsText);
					app.stage.addChild(centerStuff);
					
					
					settingsMenu.addChild(menuBack);
					settingsMenu.addChild(statsHeader);
					for( i in statsTxt )
					{
						settingsMenu.addChild(statsTxt[i]);
					}
					settingsMenu.addChild(saveButton);
					settingsMenu.addChild(saveLabel);
					app.stage.addChild(settingsMenu);
					
				
					deleteMenu.addChild(menuBack3);
					deleteMenu.addChild(yesButton);
					deleteMenu.addChild(noButton);
					deleteMenu.addChild(noLabel);
					deleteMenu.addChild(yesLabel);
					deleteMenu.addChild(deleteTitle);
					deleteMenu.addChild(deleteMessage);
					app.stage.addChild(deleteMenu);
					
					CrabMenu.addChild(menuBack2);
					CrabMenu.addChild(CrabHeader);
					CrabMenu.addChild(Alaska);
					CrabMenu.addChild(California);
					CrabMenu.addChild(AlaskaHeader);
					CrabMenu.addChild(CaliforniaHeader);
					CrabMenu.addChild(AlaskaCost);
					CrabMenu.addChild(CaliforniaCost);
					CrabMenu.addChild(AlaskaYield);
					CrabMenu.addChild(CaliforniaYield);
					app.stage.addChild(CrabMenu);
					

					app.stage.addChild( headerLeft);
					app.stage.addChild( headerRight );

					app.stage.addChild( leftHeader);
					app.stage.addChild( rightHeader );
					app.stage.addChild( goneText );
					app.stage.addChild( watermark );

					app.stage.addChild( menuRight );
					app.stage.addChild( menuLeft );
					app.stage.addChild( barRight );
					app.stage.addChild( barLeft );

					for( i = 0; i<10; i++)
					{
						buttons[i].addChild( btnTexts[i]);
						btnTexts[i].position.set(15,15);
						buttons[i].addChild( btnTexts[i+10]);
						btnTexts[i+10].position.set(20,60);
						buttons[i].addChild( btnTexts[i+20]);
						btnTexts[i+20].position.set(20,80);
						app.stage.addChild( buttons[i] );

						btnImg[i].scale.set(.62,.64);
						btnImg[i].position.set(150,15);

					}



					// phase two...
					// click stuff
					CrabButton.interactive = true;
					CrabButton.buttonMode = true;
					CrabButton
						.on( 'pointerdown', Game.mine )
						.on( 'pointerup', Graphics.Main.Up )
						.on( 'pointerover', Graphics.Main.Over )
						
						.on( 'pointerout', Graphics.Main.Out );

					Alaska.interactive=true;
					Alaska.buttonMode=true;
					Alaska
						.on( 'pointerup', Graphics.onButtonUp )
						.on( 'pointerover', Graphics.onButtonOver )
						.on( 'pointerdown', Game.node.filler.Alaska )
						.on( 'pointerout', Graphics.onButtonOut );
					Alaska.tint=(0xBBBBBB);
					
					California.interactive=true;
					California.buttonMode=true;
					California
						.on( 'pointerdown', Game.node.filler.California )
						.on( 'pointerup', Graphics.onButtonUp )
						.on( 'pointerover', Graphics.onButtonOver )
						.on( 'pointerout', Graphics.onButtonOut );
					
					California.tint=(0xBBBBBB);
					
					saveButton.interactive=true;
					saveButton.buttonMode=true;
					saveButton
						.on( 'pointerup', Graphics.onButtonUp )
						.on( 'pointerover', Graphics.onButtonOver )
						.on( 'pointerdown', Game.Deleter.open )
						.on( 'pointerout', Graphics.onButtonOut );
					saveButton.tint=(0xBBBBBB);
					
					yesButton.interactive=true;
					yesButton.buttonMode=true;
					yesButton
						.on( 'pointerup', Graphics.onButtonUp )
						.on( 'pointerover', Graphics.onButtonOver )
						.on( 'pointerdown', Game.Deleter.delete )
						.on( 'pointerout', Graphics.onButtonOut );
					yesButton.tint=(0xBBBBBB);
					
					noButton.interactive=true;
					noButton.buttonMode=true;
					noButton
						.on( 'pointerup', Graphics.onButtonUp )
						.on( 'pointerover', Graphics.onButtonOver )
						.on( 'pointerdown', Game.Deleter.close)
						.on( 'pointerout', Graphics.onButtonOut );
					noButton.tint=(0xBBBBBB);
					
					buttons[0].on('pointerdown', Game.Pickaxe.up);
					buttons[1].on('pointerdown', Game.Helmet.up);
					buttons[2].on('pointerdown', Game.Parts.up);
					buttons[3].on('pointerdown', Game.Brain.up);
					buttons[4].on('pointerdown', Game.Settings.display); 
					buttons[5].on('pointerdown', Game.node.filler.open);
					buttons[6].on('pointerdown', Game.Prospector.up);
					buttons[7].on('pointerdown', Game.Miner.up);
					buttons[8].on('pointerdown', Game.Drill.up);
					buttons[9].on('pointerdown', Game.Laser.up);

					// center stuff.
					
					glow.anchor.x = 0.5;
					glow.anchor.y = 0.5;
					glow.position.x=app.renderer.width/2;
					glow.position.y=app.renderer.height/2;
					glow.scale.set(.8,.8)
					
					Graphics.Main.Out();
					CrabButton.scale.set(.22, .22);
					center(CrabButton);

					centerX(mainText);
					mainText.position.y=50;

					centerX(CpsText);
					CpsText.position.y=100;

					centerX(goneText);
					goneText.position.y=500;
					goneText.visible=false;
					
					menuBack.scale.set(2.9,3);
					center(settingsMenu);
					settingsMenu.y+=20;
					settingsMenu.visible=false;
					
					saveButton.scale.set(.5,1);
					saveButton.position.y=(menuBack.height-saveButton.height)/2
					saveButton.position.x=(menuBack.width-saveButton.width)/4+ menuBack.width/2
					
					saveLabel.position.y=((menuBack.height-saveButton.height)/2)-25
					saveLabel.position.x=(menuBack.width-saveButton.width)/4+ menuBack.width/2 + 10
					
					
					menuBack2.scale.set(2.9,3);
					center(CrabMenu);
					CrabMenu.y+=20;
					CrabMenu.visible=false;
					
					statsHeader.position.x = (menuBack.width-statsHeader.width)/2;
					statsHeader.position.y =  20;
					for ( i in statsTxt )
					{
						statsTxt[i].position.y=80+i*20;
						statsTxt[i].position.x= 20;
					}
					
					
					CrabHeader.position.x = (menuBack2.width-CrabHeader.width)/2;
					CrabHeader.position.y =  20;
					
					Crabmiddle = menuBack2.width/2;
					
					Alaska.position.y=((menuBack2.height/2)-Alaska.width/2);
					California.position.y=((menuBack2.height/2)-Alaska.width/2);
					Alaska.position.x=(Crabmiddle-Alaska.width)/2;
					California.position.x=Crabmiddle+((Crabmiddle-California.width)/2);
					
					AlaskaHeader.position.y=290;
					CaliforniaHeader.position.y=290;
					AlaskaHeader.position.x=(Crabmiddle-AlaskaHeader.width)/2;
					CaliforniaHeader.position.x=Crabmiddle+((Crabmiddle-CaliforniaHeader.width)/2);
					
					AlaskaYield.position.y=330;
					CaliforniaYield.position.y=330;
					AlaskaYield.position.x=(Crabmiddle-AlaskaYield.width)/2;
					CaliforniaYield.position.x=Crabmiddle+((Crabmiddle-CaliforniaYield.width)/2);
					
					AlaskaCost.position.y=315;
					CaliforniaCost.position.y=315;
					AlaskaCost.position.x=(Crabmiddle-AlaskaCost.width)/2;
					CaliforniaCost.position.x=Crabmiddle+((Crabmiddle-CaliforniaCost.width)/2);
					
					menuBack3.scale.set(2.9,3);
					center(deleteMenu);
					deleteMenu.y+=20;
					deleteMenu.visible=false;
					
					deleteTitle.position.x=(menuBack3.width-deleteTitle.width)/2;
					deleteTitle.position.y=20
					
					deleteMessage.position.x=(menuBack3.width-deleteMessage.width)/2;
					deleteMessage.position.y=80
					
					yesButton.position.set((menuBack3.width-yesButton.width)/2,140);
					yesLabel.position.set((menuBack3.width-yesLabel.width)/2,yesButton.position.y+((noButton.height-yesLabel.height)/2));
					noButton.position.set((menuBack3.width-yesButton.width)/2,290);
					noLabel.position.set((menuBack3.width-noLabel.width)/2,noButton.position.y+((noButton.height-yesLabel.height)/2));
					
					let spaceMine = keyboard( " " );
					spaceMine.press = () => 
					{
						Game.mine();
					};

					// Menu.... Yeah.
					menuRight.scale.set(1, .85);
					menuLeft.scale.set(1, .85);

					menuRight.position.x=app.renderer.width-menuLeft.width;
					menuRight.position.y=app.renderer.height-menuLeft.height;

					menuLeft.position.y=app.renderer.height-menuRight.height;



					barLeft.position.x = menuLeft.width;
					barRight.position.x = app.renderer.width-(menuRight.width+barRight.width);




					leftHeader.position.y=20;
					rightHeader.position.y=20;

					leftHeader.position.x=(barLeft.position.x - leftHeader.width)/2
					rightHeader.position.x= (((app.renderer.width-(barRight.position.x+barRight.width))-rightHeader.width)/2)+barRight.position.x+barRight.width

					headerRight.x=barRight.position.x+barRight.width;
					headerRight.scale.set(1.01, 1.1);
					headerLeft.scale.set(1.01,1.1);

					watermark.position.set(menuLeft.width+barLeft.width+20,app.renderer.height-watermark.height-10);

					buttons[0].position.set(0,menuLeft.position.y+15);
					buttons[1].position.set(0,menuLeft.position.y+buttons[0].height+15);
					buttons[2].position.set(0,menuLeft.position.y+(buttons[0].height*2)+15);
					buttons[3].position.set(0,menuLeft.position.y+(buttons[0].height*3)+15);
					buttons[4].position.set(0,menuLeft.position.y+(buttons[0].height*4)+15);

					buttons[5].position.set(menuRight.x,menuLeft.position.y+15);
					buttons[6].position.set(menuRight.x,menuLeft.position.y+buttons[0].height+15);
					buttons[7].position.set(menuRight.x,menuLeft.position.y+(buttons[0].height*2)+15);
					buttons[8].position.set(menuRight.x,menuLeft.position.y+(buttons[0].height*3)+15);
					buttons[9].position.set(menuRight.x,menuLeft.position.y+(buttons[0].height*4)+15);



					// Ticker...
					app.ticker.add(delta => Game.update(delta));
					app.ticker.add(delta => Graphics.update(delta));
				},





				newCrabFrag: function( )
				{

					//Create a new Crab Frag.
					CrabFrags[ CrabFrags.length ] = new PIXI.Sprite
					(
						loader.resources["graphics/CrabFrag.png"].texture
					);


					app.stage.addChild(CrabFrags[CrabFrags.length-1]);

					CrabFrags[ CrabFrags.length-1 ].position.set
					( 
						app.renderer.plugins.interaction.mouse.global.x,
						app.renderer.plugins.interaction.mouse.global.y 
					);
					CrabFrags[CrabFrags.length-1].scale.set(.125, .125);
					CrabFrags[CrabFrags.length-1].velY=getRndInteger(-8,-15);
					CrabFrags[CrabFrags.length-1].velX=getRndInteger(-5,5);
					CrabFrags[CrabFrags.length-1].anchor.x = 0.5;
					CrabFrags[CrabFrags.length-1].anchor.y = 0.5;
					CrabFrags[CrabFrags.length-1].rotation=Math.random()*6;
					if(Game.node.left<=0)
					{
						CrabFrags[CrabFrags.length-1].tint=0x8888FF
					}

				},


				Main:
				{
					Down: function()
					{



						//mess with the button.
						CrabButton.scale.set(.22,.22);
						CrabButton.tint=0xEEEECC;
						center(CrabButton);
						Graphics.newCrabFrag();


					},

					Up: function()
					{
						CrabButton.tint=0xFFFFFF;
					},

					Over: function()
					{
						CrabButton.tint=0xFFFFFF;
						mainOver=true;
					},

					Out:function()
					{	
						CrabButton.tint=0xEEEECC;
						mainOver=false;
					}

				},






				onButtonOver:function ()
				{
					if( this.children.length == 0 )
					{
						this.tint=0xFFFFFF;
					}
					else
					{
						this.children[0].tint=0xFFFFFF;
						this.children[1].tint=0xFFFFFF;
					}
				},

				onButtonOut:function ()
				{
					if( this.children.length == 0 )
					{
						this.tint=0xCCCCCC;
					}
					else
					{
					this.children[0].tint=0xCCCCCC;
					this.children[1].tint=0xCCCCCC;
					}
				},

				onButtonUp: function()
				{
					if( this.children.length == 0 )
					{
						//this.tint=0xFFFFFF;
						
					}
					else
					{
						this.children[0].texture=btntex[0];
					}
				},








				update:function  ( delta )
				{


					//////////[ Graphics ]/////////////
					
					// update glow
					glow.scale.set(1.5+(Math.log(Game.allTimeCrab)*.1),1.5+(Math.log(Game.allTimeCrab)*.1));
					glow.rotation+=.02;
					
					if(Game.node.left==0)
					{
						glow.visible=false; 
					}
					else
					{
						glow.visible=true; 
					}
					// update Text:
					if(Game.allTimeCrab==0)
					{
							mainText.text="Mine for Crabs!";
					
					}
					else
					{
						if(Game.Crab>=1000000000)
						{
							//Math.round(num * 100) / 100
							mainText.text = "Crabs: " + (Game.Crab/1000000000).toFixed(3) + "B";
						}
						else
						{	
							if(Game.Crab>=1000000)
							{
								//Math.round(num * 100) / 100
								mainText.text = "Crabs: " + (Game.Crab/1000000).toFixed(3) + "M";
							}
							else
							{	
								if(Game.Crab>=10000)
								{
									//Math.round(num * 100) / 100
									mainText.text = "Crabs: " + (Game.Crab/1000).toFixed(2) + "K";
								}
								else
								{
									mainText.text = "Crabs: " + Math.floor(Game.Crab);
								}
							}
						}	
					}
					
					centerX(mainText);
					CpsText.text = "Cps: "+pp(Game.Cps);
					centerX(CpsText);


					// animate main button.
					if( mainOver & CrabButton.scale.x < .25)
					{

						CrabButton.scale.x = Math.round((CrabButton.scale.x+.005)* 1000) / 1000
						CrabButton.scale.y = Math.round((CrabButton.scale.y+.005)* 1000) / 1000
						center( CrabButton );

					}
					else if ( ! mainOver & CrabButton.scale.x > .22 )
					{
						CrabButton.scale.x = Math.round((CrabButton.scale.x-.005)* 1000) / 1000
						CrabButton.scale.y = Math.round((CrabButton.scale.y-.005)* 1000) / 1000

						center( CrabButton );

					}

					if(Game.node.left>0)
					{
						goneText.visible=false;
					}

					if(Game.node.left>2*(Game.node.total/3))
					{
						CrabButton.texture=textures[0];
					}

					//Choose which graphic to show.
					if(Game.node.left<=0)
					{
						CrabButton.texture=textures[3];
						goneText.visible=true;


					}
					else if(Game.node.left<=Game.node.total/3)
					{
						CrabButton.texture=textures[2];
						buttons[5].visible=true;

					}
					else if(Game.node.left<=2*(Game.node.total/3))
					{
						CrabButton.texture=textures[1];

					}


					// Make CrabFrags fall.
					for( i = 0; i < CrabFrags.length; i++ )
					{
						CrabFrags[ i ].velY++;
						CrabFrags[ i ].position.y += CrabFrags[ i ].velY;
						CrabFrags[ i ].position.x += CrabFrags[ i ].velX;



					}
					
					// misc:
					if(Game.node.total==5001)
					{
						goneText.visible=true;
						goneText.text="Lucky Break!"
					}
					else
					{
						goneText.text="Crab Depleted!"
					}

				}
					
			}
			//############# Init ################\\
			//Start the game:
			Game.init();
			
			
		</script>
		<style>body{Padding-left:5%;}</style>
	</body>
</html>
